<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<title>Shoe Tracker</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
    margin: 0;
    font-family: -apple-system, BlinkMacSystemFont, Arial, sans-serif;
    background: #0b0b0b;
    color: #eaeaea;
}

.app {
    max-width: 560px;
    margin: auto;
    padding: 28px 18px 60px;
}

h1 {
    text-align: center;
    color: #39ff14;
    font-size: 30px;
    margin-bottom: 26px;
}

.card {
    background: #141414;
    border-radius: 18px;
    padding: 22px;
    margin-bottom: 22px;
}

label {
    display: block;
    margin-top: 16px;
    font-size: 17px;
    color: #aaa;
}

input, select, button {
    width: 100%;
    margin-top: 10px;
    padding: 18px;
    border-radius: 14px;
    border: none;
    font-size: 19px;
}

input, select {
    background: #1f1f1f;
    color: white;
}

button {
    margin-top: 22px;
    background: #39ff14;
    color: black;
    font-weight: bold;
}

button.secondary {
    background: #1f1f1f;
    color: #39ff14;
    border: 1px solid #39ff14;
}

button.danger {
    background: #2a0000;
    color: #ff5c5c;
    border: 1px solid #ff5c5c;
}

.section-button {
    margin-bottom: 22px;
}

.shoe {
    padding: 18px 0;
    border-bottom: 1px solid #222;
}

.shoe:last-child {
    border-bottom: none;
}

.shoe-name {
    color: #39ff14;
    font-size: 19px;
    font-weight: bold;
    margin-bottom: 8px;
}

.stat {
    font-size: 17px;
    color: #ccc;
    margin-bottom: 4px;
}

.hidden {
    display: none;
}
</style>
</head>

<body>
<div class="app">

<h1>SHOE TRACKER</h1>

<button class="secondary section-button" onclick="toggleAddShoe()">
➕ Dodaj nowe buty
</button>

<div class="card hidden" id="addShoeCard">
<label>Nazwa modelu</label>
<input type="text" id="newShoe">
<button onclick="addShoe()">Zapisz buty</button>
</div>

<div class="card">
<label>Dystans (km)</label>
<input type="number" step="0.01" id="distance">

<label>Czas (mm:ss)</label>
<input type="text" placeholder="np. 45:30" id="time">

<label>Buty</label>
<select id="shoe"></select>

<button onclick="addRun()">Dodaj bieg</button>
</div>

<div class="card">
<h2 style="margin-top:0">Statystyki butów</h2>
<div id="shoeStats"></div>
</div>

<button class="secondary section-button" onclick="toggleSettings()">
⚙️ Ustawienia
</button>

<div class="card hidden" id="settingsCard">
<button class="danger" onclick="resetRuns()">
Wyczyść wszystkie biegi
</button>
</div>

</div>

<script>
let runs = JSON.parse(localStorage.getItem("runs")) || [];
let shoes = JSON.parse(localStorage.getItem("shoes")) || [
    "Nike AlphaFly 3",
    "Nike Zoom Fly 5"
];

function save() {
    localStorage.setItem("runs", JSON.stringify(runs));
    localStorage.setItem("shoes", JSON.stringify(shoes));
}

function toggleAddShoe() {
    document.getElementById("addShoeCard").classList.toggle("hidden");
}

function toggleSettings() {
    document.getElementById("settingsCard").classList.toggle("hidden");
}

function renderShoes() {
    const select = document.getElementById("shoe");
    select.innerHTML = "";
    shoes.forEach(s => {
        const opt = document.createElement("option");
        opt.textContent = s;
        select.appendChild(opt);
    });
}

function addShoe() {
    const name = document.getElementById("newShoe").value.trim();
    if (!name || shoes.includes(name)) return;
    shoes.push(name);
    save();
    renderShoes();
    document.getElementById("newShoe").value = "";
    toggleAddShoe();
}

function addRun() {
    const distance = parseFloat(distance.value);
    const time = timeInput.value.trim();
    const shoe = shoeSelect.value;

    if (!distance || distance <= 0) return;

    const parts = time.split(":");
    if (parts.length !== 2) return;

    const m = parseInt(parts[0], 10);
    const s = parseInt(parts[1], 10);
    if (isNaN(m) || isNaN(s) || s >= 60) return;

    runs.push({
        distance,
        seconds: m * 60 + s,
        shoe
    });

    save();
    updateStats();
    distance.value = "";
    timeInput.value = "";
}

function formatTime(sec) {
    const d = Math.floor(sec / 86400);
    sec %= 86400;
    const h = Math.floor(sec / 3600);
    sec %= 3600;
    const m = Math.floor(sec / 60);
    const s = sec % 60;
    return `${d}d ${h}h ${m}m ${s}s`;
}

function pace(secPerKm) {
    const m = Math.floor(secPerKm / 60);
    const s = Math.round(secPerKm % 60).toString().padStart(2, "0");
    return `${m}:${s} min/km`;
}

function updateStats() {
    const stats = {};
    runs.forEach(r => {
        if (!stats[r.shoe]) stats[r.shoe] = { d: 0, s: 0 };
        stats[r.shoe].d += r.distance;
        stats[r.shoe].s += r.seconds;
    });

    const el = document.getElementById("shoeStats");
    el.innerHTML = "";

    for (const shoe in stats) {
        const avg = stats[shoe].s / stats[shoe].d;
        el.innerHTML += `
        <div class="shoe">
            <div class="shoe-name">${shoe}</div>
            <div class="stat">Dystans: ${stats[shoe].d.toFixed(1)} km</div>
            <div class="stat">Czas wybiegany: ${formatTime(stats[shoe].s)}</div>
            <div class="stat">Średnie tempo: ${pace(avg)}</div>
        </div>`;
    }
}

function resetRuns() {
    if (!confirm("Na pewno usunąć WSZYSTKIE biegi?")) return;
    runs = [];
    localStorage.removeItem("runs");
    updateStats();
}

const distance = document.getElementById("distance");
const timeInput = document.getElementById("time");
const shoeSelect = document.getElementById("shoe");

renderShoes();
updateStats();
</script>
</body>
</html>
